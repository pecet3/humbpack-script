const hello = "Witaj, "

http.handle("GET /hello", fn(req, res) {
    return "<h1>" + hello + "świecie!</h1>"
})

http.handle("POST /user", fn(req, res) {
    const result = http.get_json(req)

    if (is_err(result)) {
        print("Błąd parsowania JSON: ", result)
        http.set_status(res, 400)
        return "invalid JSON"
    }
    print(result)
    const username = result["username"]
    const age = result["age"]

    const response = {
        "message": "Użytkownik " + username + " został dodany!",
        "age": age
    }
    print(response)
    http.write_json(res, response)
})

print("Serwer HTTP działa na http://127.0.0.1:8082")
http.listen("127.0.0.1:8082")
